<!--Update：页面布局顺序。
  *content: content表示一个内容块，在content之前，各种<div>样式已设置完成。在content之后，开始专注功能，比如<p><h><nav>等。
  *(<h>)：     表示在各种<div>标签的层叠样式下写的具体元素，一个<h>标签。
  *page->container：page是一个html页。container表示一个容器，已知类型有d-flex形式，已知子模块有 form-holder(表单支持)、navbar-holder(导航栏支持)。
  *container->row->col：Bootstrap基本布局格式，用于适应不同分辨率的显示屏。  
  	<div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">	bootstrap的写法，意思是屏幕大于1200px宽度的情况下布局分4列，如果屏幕大于992px小于1200px也是4列，如果屏幕大于768px小于992px是2列，如果屏幕小于768px是1列。
  *form-holder： Logo&Information Panel | Form Panel (包括信息面板和表单面板)
  	info Panel：	  info->content->logo  依次为信息块、内容块、图标块。
  	form Panel: 	form->content->form group->(<input>)		
	*navbar-holder: navbar-header | nav-menu (主导航栏，包括头部和菜单)
		navbar-header:	navbar-header->Navbar Brand | Toggle Button 依此为导航栏商标、切换按钮。
		navbar-menu:  navar-header->Logout	即为退出按钮(剩下的删掉了)。
	*(<nav side-navbar>): Sidebar Header | Sidebar Navidation Menus 			(工具栏即侧栏，包括头部和菜单)
		
-->
  		
<!-- 表单控件input、select。
	<input type="text/password/checkbox/radio/button/submit/reset/image/file/hidden" />
		分别为文本框/密码/复选框/单选按钮/按钮/提交按钮/重置按钮/图像/上传文件/隐藏域
	<select>创建单选或多选菜单。
-->

<!--Vue 基本介绍 
	vue有很多自定义指令，以v-开头，常见有v-text、v-model、v-bind、 v-if等。
	*v-text：v-text是用于操作纯文本，它会替代显示对应的数据对象上的值。当绑定的数据对象上的值发生改变，插值处的内容也会随之更新。
		说明：此处为单向绑定，数据对象上的值改变，插值会发生变化；但是当插值发生变化并不会影响数据对象的值。
		注：v-text可以简写为{{}},并且支持逻辑运算。
		注：vue中有个指令叫做 v-once 可以通过v-once与v-text结合，实现仅执行一次性的插值。
				<span v-once>这个将不会随msg属性的改变而改变: {{ msg }}</span>
		举例：
				<div id="app">
  				{{ message }}
				</div>
				var app = new Vue({
   				el : '#app',
   				data : {
    				message : 'hello world'    
 					}
 			})
	*v-html：v-html用于输出html，它与v-text区别在于v-text输出的是纯文本，浏览器不会对其再进行html解析。但v-html会将其当html标签解析后输出。
		举例：
			<div id="app">
    		<p v-html="html"></p>
			</div>
			let app = new Vue({
        el: "#app",
        data: {
            html: "<b style='color:red'>v-html</b>"
        }
    });
	*v-model：v-model通常用于表单组件的绑定，例如input，select等。它与v-text的区别在于它实现的表单组件的双向绑定，如果用于表单控件以外标签是没有用的。
		举例：	
			<div id="app">
  			<input v-model="message " />
			</div>
			var app = new Vue({
   			el : '#app',
   				data : {
    				message : 'hello world'    
 					}
			})
	*v-bind:
		注：v-bind可以简写,例如<a v-bind:href="url">等于<a :href="url">
	*v-on：
		注：v-on可以简写, 例如<a v-on:click="doSomething">等于<a @click="doSomething">
-->


<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>login</title>																	<!--Update-->
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="robots" content="index,follow">						<!--Update-->
    <!-- CSS files-->
    <!-- Bootstrap CSS-->
    <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome CSS-->
    <link rel="stylesheet" href="vendor/font-awesome/css/font-awesome.min.css">
    <!-- Fontastic Custom icon font-->
    <link rel="stylesheet" href="css/fontastic.css">
    <!-- Google fonts - Poppins -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,700">
    <!-- Theme stylesheet-->
    <link rel="stylesheet" href="css/style.default.css" id="theme-stylesheet">
    <!-- Favicon-->
    <link rel="shortcut icon" href="img/favicon.ico">
        
    <!-- Mine files-->																		<!--Update-->
		<script src="js/mine/axios.min.js"></script>					<!--Update-->
  	<script src="js/mine/lodash.js"></script>							<!--Update-->
		<script src="https://unpkg.com/vue/dist/vue.js"></script>
  	<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>		
      
    <!-- JavaScript files-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/popper.js/umd/popper.min.js"> </script>
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
    <script src="vendor/jquery.cookie/jquery.cookie.js"> </script>
    <script src="vendor/chart.js/Chart.min.js"></script>
    <script src="vendor/jquery-validation/jquery.validate.min.js"></script>
    <script src="js/charts-home.js"></script>
    <!-- Main JavaScript File-->
    <script src="js/front.js"></script> 
    
    <!-- Tweaks for older IEs--><!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
  </head>

  <body> 
    <div class="page login-page" id="app">				<!--Update：class可以指定多个值,用空格隔开.多个样式定义最终会叠加在一起应用到当前元素.-->
      <div class="container d-flex align-items-center">		<!-- 布局：page->container(d-flex)->row->col->info(d-flex)->content->logo-(<h>) -->
        <div class="form-holder has-shadow" >
          <div class="row" >
            <!-- Logo & Information Panel-->
            <div class="col-lg-6">
              <div class="info d-flex align-items-center">
                <div class="content">
                  <div class="logo">
                    <h1>春天造型</h1>
                  </div>
                  	<p>"Spring is when you feel like whistling even with a shoe full of slush."<br><span>—Doug Larson</span></p>
                </div>
              </div>
            </div>
            <!-- Form Panel -->
            <div class="col-lg-6 bg-white" >			<!--布局：col->form(d-flex)->content->form group -><h>) -->
              <div class="form d-flex align-items-center" >
                <div class="content" >
                    <div class="form-group">       
											<h1>登录</h1>
                    </div>
                    <div class="form-group"> 			<!--Update：<input>中的required data-msg参数，提交为空时显示内容   -->
                      <input type="password" class="input-material" id="login-password" v-model="admin.adminPassword" >		
                      <label for="login-password" class="label-material">登录密码</label>		 <!--Update：for属性规定 label与哪个表单元素的id绑定。 -->
                    </div>
                    <div class="form-group">       
                      <a href="reset.html" class="forgot-pass">找回密码</a>
                      <span></span>
                      <input type="button" class="btn btn-primary" id="login" value="确认" @click="confirm(admin)">
                    </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="copyrights text-center">
        <p>Design by <a href="#" class="external">Three Boys</a></p>
      </div>
    </div>
    
    <!-- Mine files-->							<!--Update-->    
		<script>
	    window.onload=function(){
	    	var v1 = new Vue({
	      	el: '#app',
	      	data:{
	          admin:{									//与控件绑定的admin
	          	id:1,
	          	adminPassword:''
	          },
	          t_adminCode:'',					//与admin.id对应的6位编号
	          r_admin:{								//存放返回数据的admin
	          	id:0,
	          	adminPassword:''
	          },
            url:"http://127.0.0.1:8888/"
	     	 	},
	      	methods:{
	      		//=======================================================================   		
	      		//初始化admin
	      		init_admin:function(){
	      			this.admin.id = 1;
	      			this.admin.adminPassword = '';
	      		},
	      		
	      		//初始化r_admin
	      		init_r_admin:function(){
	      			this.r_admin.id = 0;
	      			this.r_admin.adminPassword = '';
	      		},
	      		
	      		//int型id转化为6位string型code
	      		id_to_code:function(t_id){
	      			var  = "";
	      			var count = t_id.toString().length;
	      			
	      			if(count == 1){
	      				response = "00000"+t_id.toString();	
	      			}else if(count == 2){
	      				response = "0000"+t_id.toString();
	      			}else if(count == 3){
	      				response = "000"+t_id.toString();
	      			}else if(count == 4){
	      				response = "00"+t_id.toString();
	      			}else if(count == 5){
	      				response = "0"+t_id.toString();
	      			}else if(count == 6){
	      				response = t_id.toString();
	      			}else{
	      				response = "id_to_code error.";		//失败返回字符串”id_to_code error.“
	      			}
	      			return response;
	      		},
	      		
	      		//6位string型code转化为int型id
	      		code_to_id:function(t_code){
	      			var response = t_code.parseInt(t_code,10);			//失败返回NaN
	      			return response;
	      		},
	      		
	      		//文本校验 - 密码是否为空
	      		if_invalid:function(t_adminPassword){
	      			var response = t_adminPassword.length;
	      			return response;				//response=0表示字符串为空。
	      		},
	      		
	      		//=======================================================================
	      		//通过编号获取管理员信息。若数据库存在记录且密码正确，则将返回结果保存到r_admin;否则初始化r_admin。
          	getAdminById:function(t_id){
             	//console.log("======"+t_id+"=====");					//测试语句
             	this.$http.post(this.url+"/getAdminById",t_id,
             	{
               	headers: {
                	'Content-Type': 'text/plain'
               	}
             	}).then(
               	function(response){
               		this.init_r_admin();							//初始化r_admin
                 	if(response.body.adminPassword==this.admin.adminPassword){
                 		r_admin = response.body;
                 	}else{
                   	this.$alert("密码错误，请重新输入！");
                   	console.log("Password Error!");
                 	}
           			},
           			function(){
           				this.init_r_admin();							//初始化r_admin
                 	this.$alert("无该管理员账号！");
                 	console.log("getAdmin Error!");
              	}
           		)
           	},		

	      		//=============================================================================
	    			//"确认"响应函数      		
            confirm:function(t_admin){
            	//console.log("======"+t_admin.id+"======");							//测试语句
            	//console.log("======"+t_admin.adminPassword+"======");		//测试语句     	
            	var response = this.if_invalid(t_admin.adminPassword);		//判断密码是否为空
            	if(response == 0){																				
            		this.$alert("密码不能为空，请重新输入！");
            		console.log("Password is null!");
            		return false;
            	}
          		
            	this.getAdminById(t_admin.id);							//与后台交互
            	if(r_admin.id != 0){												//判断是否正成功获取数据
            		t_adminCode = id_to_code(r_admin.id);			//id转code
            		if(t_adminCode == "id_to_code error."){		//判断是否转化成功
            			this.$alert("管理员账号格式错误！");
            			return false;
            		}
            		window.location.href="index.html"+"?"+"code="+t_adminCode;
            	}            	                    
            }
          }
	    	});
	    }	
   </script>
  </body>
</html>